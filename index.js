require('dotenv').config();
const { TELEGRAM_BOT_TOKEN, ADMIN_ID } = process.env;
const TelegramApi = require('node-telegram-bot-api');
const bot = new TelegramApi(TELEGRAM_BOT_TOKEN, {polling: true});

// –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –±–æ—Ç–µ
const helloMsg = '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ¬´Food Options¬ªü§ç\n–Ø —É–º–Ω—ã–π –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã! –í–æ—Ç —á—Ç–æ —è —É–º–µ—é\n ....';

// TODO: –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
// TODO: ----------------------------------------------------------------
// TODO: –†–∞—Å—á—ë—Ç –∫–∞–ª–æ—Ä–∏–π –∏ –ø—Ä–æ—á–µ–≥–æ –ø–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º
// TODO: 1) –ü–æ—Ö—É–¥–µ—Ç—å/–ø–æ—Ç–æ–ª—Å—Ç–µ—Ç—å
// TODO: 2) –æ–±—â–∏–π –≤–µ—Å
// TODO: 3) % –∂–∏—Ä–∞
// TODO: 4) –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
// TODO: 5*) –ø–æ—Ö—É–¥–µ—Ç—å => -300 –æ—Ç –æ–±—â–µ–≥–æ –∫–∞–ª–æ—Ä–∞–∂–∞
// TODO: 5*) –ø–æ—Ç–æ–ª—Å—Ç–µ—Ç—å => +300 –æ—Ç –æ–±—â–µ–≥–æ –∫–∞–ª–æ—Ä–∞–∂–∞
// TODO: ----------------------------------------------------------------
// TODO: –£–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–∏—Ç–∞–Ω–∏—è
// TODO: 1) –≤–µ—á–µ—Ä (—Å 19 00 –¥–æ 22 00)
// TODO: 2) —É—Ç—Ä–æ (—Å 7 00 –¥–æ 10 00)
// TODO: ----------------------------------------------------------------
// TODO: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –æ–±—Ä–∞—â–∞—é—â–∏–º—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º (–∫–æ–Ω—Ç–∞–∫—Ç—ã –≤ –¢–ì –∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)
// TODO: ----------------------------------------------------------------
// TODO: –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–æ—Å—Ç–∞–≤–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–¥–µ—Ä–∂–∫–∞ –∏–ª–∏ –æ—Ç–º–µ–Ω–∞ –ø–æ—Å—Ç–∞–≤–∫–∏ —Å–µ–≥–æ–¥–Ω—è)
// TODO: ----------------------------------------------------------------


// –ù–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –ø–∏—Å—å–º–∞ —Ä–µ–∞–∫—Ü–∏—è
bot.on('message', async msg => {
    const username = msg.chat.username;

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–æ—Ç–∞ (–æ—Ç–∫–∞–∑—ã–≤–∞–µ–º –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏)
    if (msg.from.is_bot == true) {
        //await bot.sendMessage(ADMIN_ID, `@${username}: –û–±–Ω–∞—Ä—É–∂–µ–Ω –±–æ—Ç!!`);
        return;
    }

    const text = msg.text;
    const chatID = msg.chat.id;

    // –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    if (text == '/start') {
        await bot.sendMessage(chatID, helloMsg);
        return;
    }

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–ñ–£
    if (text == '/setting') {

    }

    // –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∞–¥–º–∏–Ω—É
    if (chatID != ADMIN_ID) {
        if (!msg.sticker) {
            await bot.sendMessage(ADMIN_ID, `@${username || chatID}: ${text}`);
        }
    }

    console.log(msg);
});
